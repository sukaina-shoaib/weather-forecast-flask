{% extends "base.html" %}
{% block title %}Weather ‚Äì {{ city }}{% endblock %}

{% block content %}
<style>
:root {
  --bg: #f5f7fb;
  --card: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --shadow: 0 8px 25px rgba(0,0,0,0.08);
  --accent: #2563eb;
}

body {
  background: var(--bg);
  color: var(--text);
}

/* ===== MAIN CARD ===== */
.weather-card {
  background: var(--card);
  padding: 28px;
  border-radius: 18px;
  box-shadow: var(--shadow);
  display: flex;
  justify-content: space-between;
  margin-bottom: 30px;
}

.temp {
  font-size: 4.5rem;
  font-weight: 700;
}

.condition {
  font-size: 1.2rem;
  color: var(--muted);
}

.meta {
  margin-top: 10px;
  display: flex;
  gap: 18px;
  font-size: 0.95rem;
}

.city-box {
  text-align: right;
}

.city-box button {
  margin-top: 12px;
  padding: 10px 18px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}

.city-box button:disabled {
  background: #cbd5e1;
  cursor: not-allowed;
}

/* ===== SECTIONS ===== */
.section-title {
  margin: 30px 0 14px;
  font-size: 1.25rem;
  font-weight: 600;
}

/* ===== HOURLY ===== */
.hourly {
  display: flex;
  gap: 16px;
  overflow-x: auto;
}

.hour-card {
  min-width: 130px;
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  text-align: center;
  box-shadow: var(--shadow);
}

.hour-card .emoji {
  font-size: 2.2rem;
}

.hour-card .temp {
  font-size: 1.4rem;
  font-weight: 600;
}

/* ===== DAILY ===== */
.daily {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
  gap: 16px;
}

.daily-card {
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  text-align: center;
  box-shadow: var(--shadow);
}

.daily-card .emoji {
  font-size: 2.2rem;
}

.daily-card .temp {
  font-size: 1.4rem;
  font-weight: 600;
}

/* ===== CHART ===== */
.chart-box {
  background: var(--card);
  padding: 20px;
  border-radius: 18px;
  box-shadow: var(--shadow);
  margin-top: 30px;
}
</style>

<!-- ================= WEATHER HEADER ================= -->
<div class="weather-card">
  <div>
    <div class="temp">{{ current.temperature }}¬∞</div>
    <div class="condition">{{ current.condition }}</div>

    <div class="meta">
      <span>üå¨ {{ current.wind_speed }} km/h</span>
      <span>üíß {{ current.humidity }}%</span>
    </div>
  </div>

  <div class="city-box">
    <strong>{{ city }}</strong><br>
    <small>Now: {{ btn_temp }}¬∞</small><br>

    <button
      {% if city_in_favs %}disabled{% endif %}
onclick="location.href='{{ url_for('weather.add_favorite', city=city) }}'">
      {% if city_in_favs %}‚òÖ Added{% else %}‚òÜ Add to favourites{% endif %}
    </button>
  </div>
</div>

<!-- ===== 6 HOURS ===== -->
<h3 class="section-title">Hourly Forecast</h3>
<div class="hourly">
  {% for h in hourly %}
  <div class="hour-card">
    <small>{{ h.time }}</small>
    <div class="emoji">{{ h.condition|icon }}</div>
    <div class="temp">{{ h.temp }}¬∞</div>
  </div>
  {% endfor %}
</div>

<!-- ===== 7 DAYS ===== -->
<h3 class="section-title">7-Day Forecast</h3>
<div class="daily">
  {% for d in daily %}
  <div class="daily-card">
    <small>{{ d.day }}</small>
    <div class="emoji">{{ d.condition|icon }}</div>
    <div class="temp">{{ d.high }}¬∞</div>
    <small>{{ d.low }}¬∞</small>
  </div>
  {% endfor %}
</div>

<!-- ===== CHART ===== -->
{% if daily %}
<div class="chart-box">
  <h4>Temperature Trend</h4>
  <canvas id="tempChart" height="120"></canvas>
</div>
{% endif %}

<a href="{{ url_for('weather.get_weather_page') }}" class="btn" style="margin-top:25px;">
  ‚Üê Search another city
</a>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
new Chart(document.getElementById("tempChart"), {
  type: "line",
  data: {
    labels: {{ chart_labels | tojson }},
    datasets: [{
      data: {{ chart_temps | tojson }},
      borderColor: "#2563eb",
      backgroundColor: "rgba(37,99,235,0.2)",
      fill: true,
      tension: 0.4
    }]
  },
  options: {
    plugins: { legend: { display: false } },
    scales: { y: { beginAtZero: false } }
  }
});
</script>
{% endblock %}